new Vue({el:"#app",data:{goodsList:[],filteredGoods:[]},props:{searchKey:String},methods:{async getItems(){try{const t=await fetch("http://localhost:3000"),e=await t.json();this.goodsList=e,this.filteredGoods=this.goodsList}catch(t){console.log("Error",t)}},filterGoods(t){console.log(this.goodsList.filter((e=>e.productName.toLowerCase().includes(t.toLowerCase())))),this.filteredGoods=this.goodsList.filter((e=>e.productName.toLowerCase().includes(t.toLowerCase())))}},mounted(){this.getItems()}}),new Vue({el:"#footer",data:{year:(new Date).getFullYear(),time:(new Date).toLocaleTimeString()}}),Vue.component("search-app",{name:"search-app",data:()=>({searchKey:""}),template:' <div class="search-app">\n                    <input type="text" v-model="searchKey" placeholder="search">\n                    <button @click="func(searchKey)">Go Search!</button>\n                </div>',props:{func:Function}}),Vue.component("list-app",{name:"list-app",props:["goods"],template:' <div class="shop-item">\n                    <item-draw-app v-for="item in goods" :item="item" :key="item.id"></item-draw-app>\n                </div>'}),Vue.component("item-draw-app",{props:["item"],data:{basket:[],basketItem:{}},template:' <div class="item-element">\n                    \x3c!-- <img :src="item.img" alt=""> --\x3e\n                    <h2 class="elem-title">{{item.productName}}</h2>\n                    <span>{{item.price}}</span>\n                    <button @click=\'clickLMB(item.id)\'>Buy</button>\n                    <hr/>\n                </div>',methods:{async clickLMB(t){let e=await fetch("http://localhost:3000/basket");const a=await e.json();let s=this.item;if(a){let t=a.find((t=>t.id===s.id));s.quantity=t?s.quantity+1:1}fetch("http://localhost:3000",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(s)})}}}),Vue.component("basket-app",{name:"basket-app",props:{filteredGoods:Array,func:Function},data:()=>({isVisibleCart:!1,cartName:"Корзина",basket:[]}),template:'<div class="basket">\n                    <button @click=\'switchState()\'>{{cartName}}</button>\n                    <div class="cart-block" v-if="isVisibleCart">\n                        <basket-draw-app v-for="item in basket" :itemToDraw="item" :key="item.id"></basket-draw-app>\n                    </div>\n                </div>',methods:{switchState(){this.isVisibleCart=!this.isVisibleCart,console.log("Now",this.isVisibleCart),this.isVisibleCart||(this.cartName="Корзина"),this.isVisibleCart&&(this.cartName="Свернуть",this.getBasket())},async getBasket(){try{const t=await fetch("http://localhost:3000/basket"),e=await t.json();this.basket=e,console.log("Log:",e)}catch(t){console.log("Error",t)}},deleteFromBasket(t){let e=this.basket.indexOf(t);this.basket.splice(e,1),fetch("http://localhost:3000/delete",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)})},addInBasket(t){t.quantity++,fetch("http://localhost:3000/",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)})},decreaseInBasket(t){t.quantity--,fetch("http://localhost:3000/",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)})}}}),Vue.component("basket-draw-app",{name:"basket-draw-app",props:{itemToDraw:Object},methods:{deleteFromBasket(t){this.$parent.deleteFromBasket(t)},addInBasket(t){this.$parent.addInBasket(t)},decreaseInBasket(t){this.$parent.decreaseInBasket(t)}},template:" <div class=\"\">\n                    \x3c!-- <img :src=\"itemToDraw.img\" alt=\"\"> --\x3e\n                    <h5 class=\"\">{{itemToDraw.productName}} - {{itemToDraw.quantity}} шт.</h5>\n                    <span>Цена {{itemToDraw.price}} за шт.</span>\n                    <button @click='addInBasket(itemToDraw)'>+</button>\n                    <button v-if='itemToDraw.quantity>1' @click='decreaseInBasket(itemToDraw)'>-</button>\n                    <button @click='deleteFromBasket(itemToDraw)'>Удалить</button>\n                    <hr/>\n                </div>"});